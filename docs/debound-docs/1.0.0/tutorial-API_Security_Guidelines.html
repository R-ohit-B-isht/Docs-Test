<!DOCTYPE html><html lang="en" style="font-size:16px"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Tutorial: API_Security_Guidelines</title><!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><script src="scripts/third-party/hljs.js" defer="defer"></script><script src="scripts/third-party/hljs-line-num.js" defer="defer"></script><script src="scripts/third-party/popper.js" defer="defer"></script><script src="scripts/third-party/tippy.js" defer="defer"></script><script src="scripts/third-party/tocbot.min.js"></script><script>var baseURL="/",locationPathname="";baseURL=(locationPathname=document.location.pathname).substr(0,locationPathname.lastIndexOf("/")+1)</script><link rel="stylesheet" href="styles/clean-jsdoc-theme.min.css"><svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none"><defs><symbol id="copy-icon" viewbox="0 0 488.3 488.3"><g><path d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z"/><path d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z"/></g></symbol><symbol id="search-icon" viewBox="0 0 512 512"><g><g><path d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z"/></g></g><g><g><path d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z"/></g></g></symbol><symbol id="font-size-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11.246 15H4.754l-2 5H.6L7 4h2l6.4 16h-2.154l-2-5zm-.8-2L8 6.885 5.554 13h4.892zM21 12.535V12h2v8h-2v-.535a4 4 0 1 1 0-6.93zM19 18a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></symbol><symbol id="add-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2z"/></symbol><symbol id="minus-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M5 11h14v2H5z"/></symbol><symbol id="dark-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938 7.999 7.999 0 0 0 4 12z"/></symbol><symbol id="light-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/></symbol><symbol id="reset-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M18.537 19.567A9.961 9.961 0 0 1 12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10c0 2.136-.67 4.116-1.81 5.74L17 12h3a8 8 0 1 0-2.46 5.772l.997 1.795z"/></symbol><symbol id="down-icon" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"></path></symbol><symbol id="codepen-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M16.5 13.202L13 15.535v3.596L19.197 15 16.5 13.202zM14.697 12L12 10.202 9.303 12 12 13.798 14.697 12zM20 10.869L18.303 12 20 13.131V10.87zM19.197 9L13 4.869v3.596l3.5 2.333L19.197 9zM7.5 10.798L11 8.465V4.869L4.803 9 7.5 10.798zM4.803 15L11 19.131v-3.596l-3.5-2.333L4.803 15zM4 13.131L5.697 12 4 10.869v2.262zM2 9a1 1 0 0 1 .445-.832l9-6a1 1 0 0 1 1.11 0l9 6A1 1 0 0 1 22 9v6a1 1 0 0 1-.445.832l-9 6a1 1 0 0 1-1.11 0l-9-6A1 1 0 0 1 2 15V9z"/></symbol><symbol id="close-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"/></symbol><symbol id="menu-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z"/></symbol></defs></svg></head><body data-theme="dark"><div class="sidebar-container"><div class="sidebar" id="sidebar"><a href="/" class="sidebar-title sidebar-title-anchor">Home</a><div class="sidebar-items-container"><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-tutorials"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-API_Guidelines.html">API_Guidelines</a></div><div class="sidebar-section-children"><a href="tutorial-API_Security_Guidelines.html">API_Security_Guidelines</a></div><div class="sidebar-section-children"><a href="tutorial-Dart_Guidelines.html">Dart_Guidelines</a></div><div class="sidebar-section-children"><a href="tutorial-JS_Guidelines.html">JS_Guidelines</a></div><div class="sidebar-section-children"><a href="tutorial-MongoDB_Guidelines.html">MongoDB_Guidelines</a></div><div class="sidebar-section-children"><a href="tutorial-Project_Guidelines.html">Project_Guidelines</a></div><div class="sidebar-section-children"><a href="tutorial-Semantic_Versioning_Guidelines.html">Semantic_Versioning_Guidelines</a></div></div></div></div></div><div class="navbar-container" id="VuAckcnZhf"><nav class="navbar"><div class="navbar-left-items"><div class="navbar-item"><a id="github" href="https://github.com/SecretStencil" target="">Github</a></div><div class="navbar-item"><a id="notion" href="https://www.notion.so" target="">Notion</a></div></div><div class="navbar-right-items"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div><nav></nav></nav></div><div class="toc-container"><div class="toc-content"><span class="bold">On this page</span><div id="eed4d2a0bfd64539bb9df78095dec881"></div></div></div><div class="body-wrapper"><div class="main-content"><div class="main-wrapper"><section><header><h2>API_Security_Guidelines</h2></header><article><h1 id="api-security-checklist">API Security Checklist</h1><p>Checklist of the most important security countermeasures when designing, testing, and releasing your API.</p><hr><h2 id="authentication">Authentication</h2><ul><li>✅ Don't use <code>Basic Auth</code>. Use standard authentication instead (e.g., <a href="https://jwt.io/">JWT</a>).</li><li>✅ Don't reinvent the wheel in <code>Authentication</code>, <code>token generation</code>, <code>password storage</code>. Use the standards.</li><li>✅ Use <code>Max Retry</code> and jail features in Login.</li><li>✅ Use encryption on all sensitive data.</li></ul><h3 id="jwt-(json-web-token)">JWT (JSON Web Token)</h3><ul><li>✅ Use a random complicated key (<code>JWT Secret</code>) to make brute forcing the token very hard.</li><li>✅ Don't extract the algorithm from the header. Force the algorithm in the backend (<code>HS256</code> or <code>RS256</code>).</li><li>✅ Make token expiration (<code>TTL</code>, <code>RTTL</code>) as short as possible.</li><li>✅ Don't store sensitive data in the JWT payload, it can be decoded <a href="https://jwt.io/#debugger-io">easily</a>.</li><li>✅ Avoid storing too much data. JWT is usually shared in headers and they have a size limit.</li></ul><h2 id="access">Access</h2><ul><li>✅ Limit requests (Throttling) to avoid DDoS / brute-force attacks.</li><li>✅ Use HTTPS on server side with TLS 1.2+ and secure ciphers to avoid MITM (Man in the Middle Attack).</li><li>✅ Use <code>HSTS</code> header with SSL to avoid SSL Strip attacks.</li><li>✅ Turn off directory listings.</li><li>✅ For private APIs, allow access only from safelisted IPs/hosts.</li></ul><h2 id="authorization">Authorization</h2><h3 id="oauth">OAuth</h3><ul><li>✅ Always validate <code>redirect_uri</code> server-side to allow only safelisted URLs.</li><li>✅ Always try to exchange for code and not tokens (don't allow <code>response_type=token</code>).</li><li>✅ Use <code>state</code> parameter with a random hash to prevent CSRF on the OAuth authorization process.</li><li>✅ Define the default scope, and validate scope parameters for each application.</li></ul><h2 id="input">Input</h2><ul><li>✅ Use the proper HTTP method according to the operation: <code>GET (read)</code>, <code>POST (create)</code>, <code>PUT/PATCH (replace/update)</code>, and <code>DELETE (to delete a record)</code>, and respond with <code>405 Method Not Allowed</code> if the requested method isn't appropriate for the requested resource.</li><li>✅ Validate <code>content-type</code> on request Accept header (Content Negotiation) to allow only your supported format (e.g., <code>application/xml</code>, <code>application/json</code>, etc.) and respond with <code>406 Not Acceptable</code> response if not matched.</li><li>✅ Validate <code>content-type</code> of posted data as you accept (e.g., <code>application/x-www-form-urlencoded</code>, <code>multipart/form-data</code>, <code>application/json</code>, etc.).</li><li>✅ Validate user input to avoid common vulnerabilities (e.g., <code>XSS</code>, <code>SQL-Injection</code>, <code>Remote Code Execution</code>, etc.).</li><li>✅ Don't use any sensitive data (<code>credentials</code>, <code>Passwords</code>, <code>security tokens</code>, or <code>API keys</code>) in the URL, but use standard Authorization header.</li><li>✅ Use only server-side encryption.</li><li>✅ Use an API Gateway service to enable caching, Rate Limit policies (e.g., <code>Quota</code>, <code>Spike Arrest</code>, or <code>Concurrent Rate Limit</code>) and deploy APIs resources dynamically.</li></ul><h2 id="processing">Processing</h2><ul><li>✅ Check if all the endpoints are protected behind authentication to avoid broken authentication process.</li><li>✅ User own resource ID should be avoided. Use <code>/me/orders</code> instead of <code>/user/654321/orders</code>.</li><li>✅ Don't auto-increment IDs. Use <code>UUID</code> instead.</li><li>✅ If you are parsing XML data, make sure entity parsing is not enabled to avoid <code>XXE</code> (XML external entity attack).</li><li>✅ If you are parsing XML, YAML or any other language with anchors and refs, make sure entity expansion is not enabled to avoid <code>Billion Laughs/XML bomb</code> via exponential entity expansion attack.</li><li>✅ Use a CDN for file uploads.</li><li>✅ If you are dealing with huge amount of data, use Workers and Queues to process as much as possible in background and return response fast to avoid HTTP Blocking.</li><li>✅ Do not forget to turn the DEBUG mode OFF.</li><li>✅ Use non-executable stacks when available.</li></ul><h2 id="output">Output</h2><ul><li>✅ Send <code>X-Content-Type-Options: nosniff</code> header.</li><li>✅ Send <code>X-Frame-Options: deny</code> header.</li><li>✅ Send <code>Content-Security-Policy: default-src 'none'</code> header.</li><li>✅ Remove fingerprinting headers - <code>X-Powered-By</code>, <code>Server</code>, <code>X-AspNet-Version</code>, etc.</li><li>✅ Force <code>content-type</code> for your response. If you return <code>application/json</code>, then your <code>content-type</code> response is <code>application/json</code>.</li><li>✅ Don't return sensitive data like <code>credentials</code>, <code>passwords</code>, or <code>security tokens</code>.</li><li>✅ Return the proper status code according to the operation completed. (e.g., <code>200 OK</code>, <code>400 Bad Request</code>, <code>401 Unauthorized</code>, <code>405 Method Not Allowed</code>, etc.).</li></ul><h2 id="ci-%26-cd">CI &amp; CD</h2><ul><li>✅ Audit your design and implementation with unit/integration tests coverage.</li><li>✅ Use a code review process and disregard self-approval.</li><li>✅ Ensure that all components of your services are statically scanned by AV software before pushing to production, including vendor libraries and other dependencies.</li><li>✅ Continuously run security tests (static/dynamic analysis) on your code.</li><li>✅ Check your dependencies (both software and OS) for known vulnerabilities.</li><li>✅ Design a rollback solution for deployments.</li></ul><h2 id="monitoring">Monitoring</h2><ul><li>✅ Use centralized logins for all services and components.</li><li>✅ Use agents to monitor all traffic, errors, requests, and responses.</li><li>✅ Use alerts for SMS, Slack, Email, Telegram, Kibana, Cloudwatch, etc.</li><li>✅ Ensure that you aren't logging any sensitive data like credit cards, passwords, PINs, etc.</li><li>✅ Use an IDS and/or IPS system to monitor your API requests and instances.</li></ul><hr><h2 id="see-also%3A">See also:</h2><ul><li><a href="https://github.com/yosriady/api-development-tools">yosriady/api-development-tools</a> - A collection of useful resources for building RESTful HTTP+JSON APIs.</li></ul><hr><h1 id="contribution">Contribution</h1><p>Feel free to contribute by forking this repository, making some changes, and submitting pull requests. For any questions drop us an email at <code>team@shieldfy.io</code>.</p></article></section></div></div></div><div class="search-container" id="PkfLWpAbet" style="display:none"><div class="wrapper" id="iCxFxjkHbP"><button class="icon-button search-close-button" id="VjLlGakifb" aria-label="close search"><svg><use xlink:href="#close-icon"></use></svg></button><div class="search-box-c"><svg><use xlink:href="#search-icon"></use></svg> <input type="text" id="vpcKVYIppa" class="search-input" placeholder="Search..." autofocus></div><div class="search-result-c" id="fWwVHRuDuN"><span class="search-result-c-text">Type anything to view search result</span></div></div></div><div class="mobile-menu-icon-container"><button class="icon-button" id="mobile-menu" data-isopen="false" aria-label="menu"><svg><use xlink:href="#menu-icon"></use></svg></button></div><div id="mobile-sidebar" class="mobile-sidebar-container"><div class="mobile-sidebar-wrapper"><a href="/" class="sidebar-title sidebar-title-anchor">Home</a><div class="mobile-nav-links"><div class="navbar-item"><a id="github-mobile" href="https://github.com/SecretStencil" target="">Github</a></div><div class="navbar-item"><a id="notion-mobile" href="https://www.notion.so" target="">Notion</a></div></div><div class="mobile-sidebar-items-c"><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-tutorials"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-API_Guidelines.html">API_Guidelines</a></div><div class="sidebar-section-children"><a href="tutorial-API_Security_Guidelines.html">API_Security_Guidelines</a></div><div class="sidebar-section-children"><a href="tutorial-Dart_Guidelines.html">Dart_Guidelines</a></div><div class="sidebar-section-children"><a href="tutorial-JS_Guidelines.html">JS_Guidelines</a></div><div class="sidebar-section-children"><a href="tutorial-MongoDB_Guidelines.html">MongoDB_Guidelines</a></div><div class="sidebar-section-children"><a href="tutorial-Project_Guidelines.html">Project_Guidelines</a></div><div class="sidebar-section-children"><a href="tutorial-Semantic_Versioning_Guidelines.html">Semantic_Versioning_Guidelines</a></div></div></div><div class="mobile-navbar-actions"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div></div></div><script type="text/javascript" src="scripts/core.min.js"></script><script src="scripts/search.min.js" defer="defer"></script><script src="scripts/third-party/fuse.js" defer="defer"></script><script type="text/javascript">var tocbotInstance=tocbot.init({tocSelector:"#eed4d2a0bfd64539bb9df78095dec881",contentSelector:".main-content",headingSelector:"h1, h2, h3",hasInnerContainers:!0,scrollContainer:".main-content",headingsOffset:130,onClick:bringLinkToView})</script></body></html>